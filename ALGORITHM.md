# Алгоритм распределения кусков пиццы

## Основная логика

### 1. Расчет количества пицц

**Правильная последовательность:**
```
// Шаг 1: Получаем общее количество желаемых кусков
totalMinSlices = сумма минимальных кусков всех пользователей

// Шаг 2: Находим ближайшее оптимальное количество пицц
basePizzaCount = Math.ceil(totalMinSlices / slicesPerPizza)

// Шаг 3: Создаем список пицц (PizzaList)
pizzaList = createPizzaList(basePizzaCount)
// Каждая пицца имеет:
// - id: уникальный идентификатор
// - slices: количество кусков (из настроек)
// - price: цена
// - isFree: бесплатная или нет

// Шаг 4: Суммируем куски всех пицц в списке
totalPizzaSlices = pizzaList.reduce((sum, pizza) => sum + pizza.slices, 0)

// Шаг 5: ТОЛЬКО ТЕПЕРЬ распределяем куски на человека
```

### 2. Распределение лишних кусков

**Схема:**
```
pieces = totalPizzaSlices - totalMinSlices  // Лишние куски

For each user from users:
  If user.canBeMore AND pieces > 0:
    user.actualSlices++
    pieces--
    
    If pieces = 0:
      Exit
Next user
```

**Пояснение:**
- Каждый пользователь сначала получает минимальное количество кусков (`minSlices`)
- Лишние куски распределяются между пользователями с `canBeMore = true`
- Распределение идет последовательно от первого пользователя
- Каждому добавляется по 1 кусочку за раз
- Процесс останавливается, когда лишних кусков не осталось
- **Важно:** Теперь используется булевая переменная `canBeMore` вместо `maxSlices`

### 3. Варианты расчета

**Если лишних кусков 1-4 (меньше половины пиццы):**
- Показываются два варианта:
  1. **С лишними кусками** - текущий расчет
  2. **Убрать лишние** - расчет с на 1 пиццу меньше (показывает сколько не хватит)

**Если лишних кусков > 4:**
- Показывается только основной расчет
- Информация о большом количестве лишних кусков

### 4. Отображение пользователям

Для каждого пользователя показывается:
- **Требуемое количество** - то, что пользователь выбрал (редактируемое)
- **Фактическое количество** - после распределения лишних кусков
- **Дополнительные куски** - зеленым текстом, если получит больше минимума

## Примеры

### Пример 1: Без лишних кусков
```
User 1: 3 куска, canBeMore = true
User 2: 2 куска, canBeMore = false
User 3: 3 куска, canBeMore = true

Минимум нужно: 3 + 2 + 3 = 8 кусков
Пицц: ceil(8/8) = 1
Всего кусков в пиццах: 8
Лишних: 0

Результат:
User 1: 3 куска
User 2: 2 куска
User 3: 3 куска
```

### Пример 2: С лишними кусками
```
User 1: 2 куска, canBeMore = true
User 2: 2 куска, canBeMore = false
User 3: 2 куска, canBeMore = true

Минимум нужно: 2 + 2 + 2 = 6 кусков
Пицц: ceil(6/8) = 1
Всего кусков в пиццах: 8
Лишних: 2

Распределение (по порядку):
1. User 1: canBeMore=true, pieces=2 → actualSlices=3, pieces=1
2. User 2: canBeMore=false → пропускаем
3. User 3: canBeMore=true, pieces=1 → actualSlices=3, pieces=0, exit

Результат:
User 1: 3 куска (+1 доп.)
User 2: 2 куска
User 3: 3 куска (+1 доп.)
Лишних: 0
```

### Пример 3: Два варианта (1-4 лишних)
```
User 1: 3 куска, строго 3
User 2: 2 куска, строго 2

Минимум нужно: 5 кусков
Пицц: ceil(5/8) = 1
Всего кусков: 8
Лишних: 3

Вариант 1 (с лишними):
- 1 пицца, 0 бесплатных, 3 лишних

Вариант 2 (убрать пиццу):
- 0 пицц, 0 бесплатных, -5 не хватает
```

